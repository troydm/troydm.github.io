<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: java | Troydm's Blog]]></title>
  <link href="http://troydm.github.io/blog/categories/java/atom.xml" rel="self"/>
  <link href="http://troydm.github.io/"/>
  <updated>2015-11-08T03:34:02+04:00</updated>
  <id>http://troydm.github.io/</id>
  <author>
    <name><![CDATA[Dmitry Geurkov]]></name>
    <email><![CDATA[d.geurkov@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Write you a Monad for no particular reason at all!]]></title>
    <link href="http://troydm.github.io/blog/2015/01/25/write-you-a-monad-for-no-particular-reason-at-all/"/>
    <updated>2015-01-25T19:01:12+04:00</updated>
    <id>http://troydm.github.io/blog/2015/01/25/write-you-a-monad-for-no-particular-reason-at-all</id>
    <content type="html"><![CDATA[<p><a href="http://en.wikipedia.org/wiki/Functional_programming">Functional Programming</a> paradigm and languages that fully utilize it&rsquo;s benefits are slowly gaining popularity nowadays not only in academia but also in enterprise becoming de facto standard for future generations of programmers. Maybe in 10 years from now humanity will come up with a better idea of how to make bug-free quality software that does the job and takes less effort to produce, however currently we are living in a century of <em>Object Oriented</em> programming systems slowly morphing into <em>Functional Programming</em> systems. There are a lot of learning resources on internet about <a href="https://www.quora.com/What-are-some-good-resources-for-learning-about-functional-programming-Why">Function Programming</a> in general and Functional Languages such as <a href="https://www.haskell.org/">Haskell</a>, <a href="http://www.erlang.org/">Erlang</a>, <a href="http://www.scala-lang.org/">Scala</a>, <a href="http://clojure.org/">Clojure</a> and many other. You all probably heard about <a href="http://learnyouahaskell.com/">Learn you a Haskell for Great Good</a> book, a really bright, colorful and interesting book that got me into Haskell programming few years ago. Some of you may even tried reading it. I think most of people without prior functional programming experience that start reading it sooner or later hit a bottom of their mental capacity while trying to comprehend <em>Monads</em>. This article is intended for this people! Yes this post is all about <em>Functors</em> and <em>Monads</em> you heard it right! In order to explore the ideas of functional programming let&rsquo;s create a small functional programming library in <strong>Java</strong> that will have <em>Functors</em> and <em>Monads</em> and by doing so learn about functional programming from a really unusual perspective of using Object Oriented programming. Our target compiler will be <strong>Java 6</strong> (yes we won&rsquo;t be using new fancy <strong>Java 8</strong>) as most of the people that are reading this now are probably more familiar with it rather than newer version. For those of you who are too lazy to follow can check the whole thing at my <a href="https://github.com/troydm/fpj">fpj</a> repository, however I strongly encourage you to try reimplement it all by yourself from scratch. The information described in this post implies that you have prior experience or basic understand of <em>Monads</em> but want to better understand them internally. So let&rsquo;s get to work!</p>

<p><img src="http://i.imgur.com/xT0ABh8.gif" alt="Rikka loli" /></p>

<!-- more -->


<p>First of all let&rsquo;s start with key concept of functional programming, a <em>function</em>. A <em>function</em> is something that takes <strong>A</strong> and produces <strong>B</strong> by a process called application of <em>function</em>. Let&rsquo;s implement it in <strong>Java</strong> using generic interface. Basically any object that implements that interface can be considered a valid function.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">B</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>A predicate is a function that takes <strong>A</strong> and produces boolean value.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Predicate</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Wait what if we don&rsquo;t need to produce any result or have any argument what we should do then? A Unit is an object that represents exactly this or simply nothing.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Unit</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Unit</span> <span class="n">unit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Unit</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="n">Unit</span> <span class="nf">unit</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">unit</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>What if we need to take more than one object and produce more too? That&rsquo;s what a <em>Tuple</em> is for. You can even use <em>Tuple</em> to combine more than two objects by putting a <em>Tuple</em> inside another <em>Tuple</em>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">A</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'><span class="kd">private</span> <span class="n">B</span> <span class="n">b</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">tuple</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;first argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">b</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;second argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">Tuple</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">first</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">getFirst</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">B</span> <span class="nf">second</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">b</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">B</span> <span class="nf">getSecond</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">b</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now let&rsquo;s discover a way of how to use functions. Let&rsquo;s define a helper class called <em>Functional</em> and put some static methods into it. The functions we are going to write are so simple and common that any functional programmer can&rsquo;t live without them. First of all what can we do with functions? Yes definitely we can combine a function with another function so basically if we have a function that takes <strong>A</strong> and produces <strong>B</strong>, and we have a function that takes <strong>B</strong> and produces <strong>C</strong> we can combine this two into a function that has a following type description <strong>A</strong> <em>&ndash;></em> <strong>C</strong> (following from here we&rsquo;ll be using a short notion of <strong>A</strong> <em>&ndash;></em> <strong>B</strong> to describe a function that takes <strong>A</strong> and produces <strong>B</strong>).</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">compose</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">g</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">C</span> <span class="nf">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">};</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>What else can we do with functions? Yes, exactly we can map them over a <em>Collection</em> of objects and produce a <em>Collection</em> of results.
So if we have a function <strong>A</strong> <em>&ndash;></em> <strong>B</strong> and a <em>Collection</em> of <strong>A</strong> objects we can map it over that <em>Collection</em> to produce resulting <em>Collection</em> of <strong>B</strong> objects.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">map</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Functional</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">f</span><span class="o">,</span> <span class="n">ac</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">ac</span><span class="o">.</span><span class="na">size</span><span class="o">()));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">map</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bc</span><span class="o">){</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>        <span class="n">bc</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">bc</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>If we don&rsquo;t need results we can just do foreach over this <em>Collection</em> same way, throwing away function result each time we apply the function.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="kt">void</span> <span class="n">foreach</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>        <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>We can also fold a value over collection using a function. So basically if we have initial value of <strong>A</strong>, <em>Collection</em> of <strong>B</strong> and function that takes <strong>A</strong> <em>&ndash;></em> <strong>B</strong> <em>&ndash;></em> <strong>A</strong> we can fold it over by
applying the function to an initial value and first object in <em>Collection</em> and then repeating the process with the result of this application with the rest of the <em>Collection</em> objects.
In functional programming this is usually called left fold.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">A</span> <span class="n">foldLeft</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bc</span><span class="o">){</span>
</span><span class='line'>    <span class="n">A</span> <span class="n">acc</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">B</span> <span class="n">b</span> <span class="o">:</span> <span class="n">bc</span><span class="o">){</span>
</span><span class='line'>        <span class="n">acc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">acc</span><span class="o">,</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">acc</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now let&rsquo;s explore another way of making a function that takes several arguments and produces a result.
We can use <em>Tuple</em> for this however sometimes it&rsquo;s easier to define it more simpler like this.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>This definition is interchangeable with definition of <em>Function&lt;Tuple&lt;A,B&gt;,C&gt;</em> so we can make a helper method in <em>Functional</em> class that can take a function that takes a <em>Tuple</em> and produce <em>Function2</em> if needed and vice versa.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">toFunction</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">C</span> <span class="nf">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">first</span><span class="o">(),</span><span class="n">t</span><span class="o">.</span><span class="na">second</span><span class="o">());</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">};</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">toFunction2</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">C</span> <span class="nf">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">};</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>We can then define a helper to flip the arguments of this function if needed</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">flip</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">C</span> <span class="nf">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">};</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>We can partially apply an argument to a <em>Function2</em> of type <strong>A</strong> <em>&ndash;></em> <strong>B</strong> <em>&ndash;></em> <strong>C</strong> transforming it into <em>Function</em> of type <strong>B</strong> <em>&ndash;></em> <strong>C</strong>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">partialApply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">C</span> <span class="nf">apply</span><span class="o">(</span><span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">};</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>We can also delay the application of an argument to a function by creating another function that takes <em>Unit</em> instead of the argument. This concept is usually called lazy function.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">lazyApply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">B</span> <span class="nf">apply</span><span class="o">(</span><span class="n">Unit</span> <span class="n">unit</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">};</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>And finally we can do the same folding we did previously only starting from the last element of the <em>Collection</em> instead of the first. This is called folding from the right or simply right fold. We can make use of previously defined <em>foldLeft</em> method and <em>Java</em>&rsquo;s <em>ListIterator</em> and <em>flip</em> helper method we defined earlier to do that easily.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">B</span> <span class="n">foldRight</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">ac</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">b</span><span class="o">;</span>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">reversed</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">ac</span><span class="o">);</span>
</span><span class='line'>    <span class="n">Collections</span><span class="o">.</span><span class="na">reverse</span><span class="o">(</span><span class="n">reversed</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Functional</span><span class="o">.</span><span class="na">foldLeft</span><span class="o">(</span><span class="n">Functional</span><span class="o">.</span><span class="na">flip</span><span class="o">(</span><span class="n">f</span><span class="o">),</span> <span class="n">b</span><span class="o">,</span> <span class="n">reversed</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now all this is cool and interesting but wait didn&rsquo;t we said at the beginning that this post is about Functors and Monads. Sure we did so let&rsquo;s start exploring these concepts!
First of all what is a <em>Functor</em>? A <em>Functor</em>&lt;A&gt; is some object that contains <strong>A</strong> and you can apply a function of type definition <strong>A</strong> <em>&ndash;></em> <strong>B</strong> to. This transforms it into another <em>Functor</em>&lt;B&gt; that contains result of that application, <strong>B</strong> value. For example we can consider a <em>Collection</em>&lt;A&gt; to be a <em>Functor</em>&lt;A&gt; because we can apply a function of <strong>A</strong> <em>&ndash;></em> <strong>B</strong> over all objects of that <em>Collection</em> and have a <em>Collection</em>&lt;B&gt; of results of that application. Simple? Yeah well not really that simple as it may sound however you&rsquo;ll understand it eventually I hope.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Functor</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>But what about <em>Monad</em>? Well the concept of <em>Monad</em> is really close to the concept of <em>Functor</em>. <em>Monad</em>&lt;A&gt; is some object that contains <em>A</em> that can be transformed into <em>Monad</em>&lt;B&gt; by application of function of type definition <em>A &ndash;> Monad&lt;B&gt;</em>. In functional programming this is called monadic bind. Also if we have <strong>B</strong> value we can transform it into <em>Monad&lt;B&gt;</em>. This is called <em>return</em> but in our framework we&rsquo;ll name it shortly <em>ret</em> because <em>return</em> is <strong>Java</strong> <em>keyword</em> which can&rsquo;t be used for a method name. But that&rsquo;s not all there is more! Any <em>Monad</em> is a <em>Functor</em> too our <em>Monad</em> interface will extend <em>Functor</em> interface!</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Monad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Functor</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now we have a base for our functional programming framework. Let&rsquo;s write some monads to better understand the concepts behind it. But before we do that let&rsquo;s define some base abstract class
that will have one another kind of monadic bind method that can be used on any <em>Monad&lt;A&gt;</em> binding it to a <em>Monad&lt;B&gt;</em> just by specifying the <em>Monad&lt;B&gt;</em> itself instead of function. Also we can use <em>Function&lt;A,B&gt;</em> for monadic bind too by combining it&rsquo;s result with <em>ret</em>, this method we will call <em>liftM</em>!</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractMonad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Monad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nf">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">b</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>     <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">liftM</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nf">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">ret</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>     <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Let&rsquo;s write our first <em>Monad</em>. It&rsquo;s called <em>Maybe&lt;A&gt;</em> and it can either contain <strong>A</strong> value or be empty! As you can see we need some methods in order to look inside this <em>Monad</em> and check if it contains a value or not! Also we&rsquo;ll need to implement <em>fmap</em> method for it to be a <em>Functor</em> and <em>bind</em> and <em>ret</em> methods for it to be a <em>Monad</em>! Implementing <em>fmap</em> is simple, we simply look into the <em>Monad</em> if it contains a value we apply provided function to this value, if not then we just return empty <em>Maybe&lt;A&gt;</em> monad. Same with the bind method but we don&rsquo;t need additional step of creating a <em>Maybe&lt;A&gt;</em> monad as the provided function returns it!</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Maybe</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">A</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Maybe</span> <span class="n">nothing</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Maybe</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">just</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">a</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">nothing</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">(</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span> <span class="n">nothing</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">Maybe</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">value</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">getValue</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isNothing</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasValue</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">isNothing</span><span class="o">()){</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">Maybe</span><span class="o">.</span><span class="na">nothing</span><span class="o">();</span>
</span><span class='line'>    <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Maybe</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">isNothing</span><span class="o">())</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">Maybe</span><span class="o">.</span><span class="na">nothing</span><span class="o">();</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">Maybe</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">value</span><span class="o">()));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now that we have <em>Maybe</em> monad we can implement another method in <em>Functional</em> class called <em>find</em>. Basically what find does is that it takes some <em>Predicate</em> function and a <em>Collection</em> of objects to check this predicate
and it returns the first element of that <em>Collection</em> for which the <em>Predicate</em> returns <em>true</em>. If for all elements the <em>Predicate</em> is false it returns empty <em>Maybe</em> monad.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">find</span><span class="o">(</span><span class="kd">final</span> <span class="n">Predicate</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>        <span class="k">if</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">))</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">Maybe</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Maybe</span><span class="o">.</span><span class="na">nothing</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="kt">boolean</span> <span class="n">exists</span><span class="o">(</span><span class="kd">final</span> <span class="n">Predicate</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Functional</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">f</span><span class="o">,</span><span class="n">ac</span><span class="o">).</span><span class="na">hasValue</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Next is <em>Either&lt;A,B&gt;</em> monad. This monad contains either left <em>A</em> or right <em>B</em> value. This can be used to propagate exceptions or be used in any case where you need to either return one value or another but not both at the same time. Note this is <em>Monad&lt;B&gt;</em>. This code is almost identical to <em>Maybe&lt;A&gt;</em> but instead of
returning empty value we return the monad itself since in the case of left value it can be considered a <em>Either&lt;A,C&gt;</em> monad.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonad</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">A</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'><span class="kd">private</span> <span class="n">B</span> <span class="n">b</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">left</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">a</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">right</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">b</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="kc">null</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">Either</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isLeft</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">b</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isRight</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">B</span> <span class="nf">right</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">b</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;is not right&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">b</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">B</span> <span class="nf">getRight</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">b</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;is not right&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">b</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">left</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;is not left&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">getLeft</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;is not left&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">isRight</span><span class="o">())</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">right</span><span class="o">());</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="nf">return</span> <span class="o">(</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="k">this</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="n">C</span> <span class="n">c</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Either</span><span class="o">.</span><span class="na">right</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">isRight</span><span class="o">())</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">Either</span><span class="o">.</span><span class="na">right</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">right</span><span class="o">()));</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="nf">return</span> <span class="o">(</span><span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="k">this</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Next is a <em>Reader&lt;A&gt;</em> <em>Monad</em>. This <em>Monad</em> is usually used to propagate immutable piece of data such as configuration across your code. It&rsquo;s an interesting case to implement. We could implement it using a <em>Tuple&lt;E,A&gt;</em> however it&rsquo;s traditionally implemented as <em>Function&lt;E,A&gt;</em>. In order to get <em>E</em> value we implement <em>ask</em> method. For the rest of the methods we usually call <em>runReader()</em> and then apply <em>E</em> value to them. This way we propagate the <em>E</em> value across binded <em>Reader</em> monad&rsquo;s safely.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">reader</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">f</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">f</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">Reader</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runReader</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">E</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ask</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">E</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;((</span><span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">E</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">Identity</span><span class="o">.</span><span class="na">identity</span><span class="o">());</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span>
</span><span class='line'>            <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>                <span class="kd">public</span> <span class="n">B</span> <span class="nf">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">E</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>                    <span class="k">return</span> <span class="o">((</span><span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">runReader</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">)))</span>
</span><span class='line'>                                <span class="o">.</span><span class="na">runReader</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span>
</span><span class='line'>            <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>               <span class="kd">public</span> <span class="n">B</span> <span class="nf">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">E</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>                   <span class="k">return</span> <span class="n">b</span><span class="o">;</span>
</span><span class='line'>               <span class="o">}</span>
</span><span class='line'>            <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Reader</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span>
</span><span class='line'>            <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>               <span class="kd">public</span> <span class="n">B</span> <span class="nf">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">E</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>                   <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">runReader</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">));</span>
</span><span class='line'>               <span class="o">}</span>
</span><span class='line'>           <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Before implementing next <em>Monad</em> let&rsquo;s explore another concept of Functional Programming called <em>Monoid</em>. Basically <em>Monoid</em> is some entity that can be empty or non-empty and can be appended to another <em>Monoid</em>. Appending empty <em>Monoid</em> to non-empty <em>Monoid</em> gives you the same non-empty <em>Monoid</em>. Simplest example of <em>Monoid</em> are natural numbers. In case of natural numbers we can consider zero as empty <em>Monoid</em> and any non-zero number to be non-empty <em>Monoid</em> and operation of appending two <em>Monoid</em>s to be addition of natural numbers. Let&rsquo;s write an interface of <em>Monoid</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Monoid</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">mempty</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">mappend</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Before we continue implementing monads let&rsquo;s implement one example of <em>Monoid</em>. First we&rsquo;ll define an <em>AbstractMonoid</em> class that will have some additional methods called <em>mconcat</em> for <em>mappend</em>-ing <em>List</em> or <em>Collection</em> of <em>Monoid</em>s starting from an empty <em>Monoid</em>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractMonoid</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Monoid</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">mconcat</span><span class="o">(</span><span class="kd">final</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">al</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Functional</span><span class="o">.</span><span class="na">foldLeft</span><span class="o">(</span><span class="k">new</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="na">mappend</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">},</span> <span class="k">this</span><span class="o">.</span><span class="na">mempty</span><span class="o">(),</span> <span class="n">al</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">mconcat</span><span class="o">(</span><span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">Functional</span><span class="o">.</span><span class="na">foldLeft</span><span class="o">(</span><span class="k">new</span> <span class="n">Function2</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="na">mappend</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">},</span> <span class="k">this</span><span class="o">.</span><span class="na">mempty</span><span class="o">(),</span> <span class="n">ac</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>And now we are ready to implement <em>List</em> <em>Monoid</em> which is basically a linked list of nodes that are either empty or contain a value and reference to next list node.
This implementing is ugly due to lack of <a href="http://en.wikipedia.org/wiki/Tail_call">TCO</a> in <strong>Java</strong>, however it&rsquo;s not too complex and just repeats any linked list implementation in <strong>Java</strong> or any other
programming language.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">List</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonoid</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Functor</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">A</span> <span class="n">hd</span><span class="o">;</span>
</span><span class='line'><span class="kd">private</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">tl</span><span class="o">;</span>
</span><span class='line'><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">List</span> <span class="n">empty</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span><span class="kc">null</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">list</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">head</span><span class="o">,</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">tail</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;head has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">tail</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;tail has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">head</span><span class="o">,</span><span class="n">tail</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">list</span><span class="o">(</span><span class="kd">final</span> <span class="n">Collection</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">l</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">r</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ac</span><span class="o">){</span>
</span><span class='line'>        <span class="k">if</span><span class="o">(</span><span class="n">l</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
</span><span class='line'>            <span class="n">l</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">a</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span><span class='line'>            <span class="n">r</span> <span class="o">=</span> <span class="n">l</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span><span class='line'>            <span class="n">l</span><span class="o">.</span><span class="na">tl</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">a</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span><span class='line'>            <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="na">tl</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">r</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="o">(</span><span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">List</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="n">l</span><span class="o">.</span><span class="na">tl</span> <span class="o">=</span> <span class="n">List</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">r</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">empty</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">empty</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">List</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">head</span><span class="o">,</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">tail</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">hd</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">tl</span> <span class="o">=</span> <span class="n">tail</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">value</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">hd</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;head has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">hd</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">getValue</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">hd</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;head has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">hd</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">int</span> <span class="nf">length</span><span class="o">(){</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">l</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="na">hasValue</span><span class="o">()){</span>
</span><span class='line'>        <span class="n">len</span><span class="o">++;</span>
</span><span class='line'>        <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="na">tail</span><span class="o">();</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">len</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">A</span> <span class="nf">head</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">hd</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;head has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">hd</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">tail</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">tl</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">&quot;has no tail&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tl</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">hd</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmptyTail</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tl</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasValue</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">hd</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">mempty</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">List</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">mappend</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monoid</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">r</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span><span class="o">(!</span><span class="n">r</span><span class="o">.</span><span class="na">isEmptyTail</span><span class="o">()){</span>
</span><span class='line'>        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="na">tl</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">r</span><span class="o">.</span><span class="na">tl</span> <span class="o">=</span> <span class="o">(</span><span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">a</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">List</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">al</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">al</span><span class="o">.</span><span class="na">value</span><span class="o">()),(</span><span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">List</span><span class="o">.</span><span class="na">empty</span><span class="o">());</span>
</span><span class='line'>    <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span><span class="o">(!</span><span class="n">al</span><span class="o">.</span><span class="na">isEmptyTail</span><span class="o">()){</span>
</span><span class='line'>        <span class="n">al</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="na">tail</span><span class="o">();</span>
</span><span class='line'>        <span class="n">r2</span><span class="o">.</span><span class="na">tl</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">al</span><span class="o">.</span><span class="na">value</span><span class="o">()),</span> <span class="n">r2</span><span class="o">.</span><span class="na">tl</span><span class="o">);</span>
</span><span class='line'>        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">.</span><span class="na">tl</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">r</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now that we have <em>Monoid</em> let&rsquo;s implement a <em>Writer&lt;W,A&gt;</em> monad. It&rsquo;s used when we need to collect some values as we go, for example log messages. Note that W needs to be a valid <em>Monoid</em>, without this
we can&rsquo;t collect values into one entity. Inside we use <em>Tuple&lt;A,W&gt;</em> to store values. We have <em>tell</em> method to <em>mappend</em> new <em>Monoid</em> values to <em>Writer</em> and by unwrapping the <em>Tuple&lt;A,W&gt;</em> we can
bind it to another <em>Writer&lt;W,B&gt;</em> monad.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Writer</span><span class="o">&lt;</span><span class="n">W</span> <span class="kd">extends</span> <span class="n">Monoid</span><span class="o">,</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span> <span class="kd">extends</span> <span class="n">Monoid</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">writer</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">t</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">t</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span> <span class="kd">extends</span> <span class="n">Monoid</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">writer</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">W</span> <span class="n">w</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">w</span><span class="o">));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">Writer</span><span class="o">(</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runWriter</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">t</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">tell</span><span class="o">(</span><span class="kd">final</span> <span class="n">W</span> <span class="n">w</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">Unit</span><span class="o">.</span><span class="na">unit</span><span class="o">(),</span>
</span><span class='line'>                              <span class="o">(</span><span class="n">W</span><span class="o">)</span><span class="n">runWriter</span><span class="o">().</span><span class="na">second</span><span class="o">().</span><span class="na">mappend</span><span class="o">(</span><span class="n">w</span><span class="o">)));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="kd">final</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span> <span class="o">=</span> <span class="o">(</span><span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">runWriter</span><span class="o">().</span><span class="na">first</span><span class="o">());</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">runWriter</span><span class="o">().</span><span class="na">first</span><span class="o">(),</span>
</span><span class='line'>                           <span class="o">(</span><span class="n">W</span><span class="o">)</span><span class="n">runWriter</span><span class="o">().</span><span class="na">second</span><span class="o">().</span><span class="na">mappend</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">runWriter</span><span class="o">().</span><span class="na">second</span><span class="o">())));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">runWriter</span><span class="o">().</span><span class="na">second</span><span class="o">()));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">Writer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">runWriter</span><span class="o">().</span><span class="na">first</span><span class="o">()),</span>
</span><span class='line'>                           <span class="n">runWriter</span><span class="o">().</span><span class="na">second</span><span class="o">()));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Next let&rsquo;s implement another monad called <em>State&lt;S,A&gt;</em>. Basicly <em>State</em> <em>Monad</em> is needed when we need some mutable value across whole computation and in a sense it&rsquo;s like programming in any imperative language.
<em>State</em> monad inside is actually a <em>Function&lt;S,Tuple&lt;A,S&gt;&gt;</em>. Basically we can imagine a <em>State</em> monad as a <em>Function</em> that takes some state <em>S</em> and returns <em>Tuple</em> that contains <em>A</em> and possibly changed state <em>S</em>. In a sense it&rsquo;s implementation is like <em>Writer</em> and <em>Reader</em> monads combined. We have two methods <em>get</em> and <em>set</em> to get current state value and modify it during computation.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">state</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">f</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">f</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">state</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">State</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runState</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">get</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">s</span><span class="o">,</span><span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">put</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">ns</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">Unit</span><span class="o">.</span><span class="na">unit</span><span class="o">(),</span><span class="n">ns</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(((</span><span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span>
</span><span class='line'>                        <span class="n">runState</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">first</span><span class="o">()</span>
</span><span class='line'>                    <span class="o">)).</span><span class="na">runState</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">first</span><span class="o">(),</span> <span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">b</span><span class="o">,</span><span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">State</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">runState</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">first</span><span class="o">()),</span><span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now what if we need <em>Reader</em> monad and at the same time we need some mutation that <em>State</em> monad provides. Yes we need something that will combine the power of both monads into one.
This is what <em>Monad Transformer</em> can do. First of all any <em>Monad Transformer</em> is also a <em>Monad</em>. We can <em>lift</em> any <em>Monad&lt;A&gt;</em> into <em>MonadTrans&lt;A&gt;</em>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MonadTrans</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">MonadTrans</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">lift</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Before we&rsquo;ll start implementing <em>Monad Transformer</em>s let&rsquo;s write some abstract base class that every <em>Monad Transformer</em> will inherit.
It will have only one method called <em>lift</em> that will allow any <em>Monad</em> to be lifted into <em>Monad Transformer</em>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractMonadTrans</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonad</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">MonadTrans</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="n">MonadTrans</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">lift</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">(</span><span class="n">MonadTrans</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">m</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">ret</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>First let&rsquo;s implement <em>MaybeT&lt;M,A&gt;</em> monad transformer. Note that <em>M</em> needs to be a valid <em>Monad</em> and so we use <em>extends</em> type definition.
Internally <em>MaybeT</em> is a <em>Monad&lt;Maybe&lt;A&gt;&gt;</em>. We check it&rsquo;s value by binding a function and inside we check if value is not empty we apply the provided function, if not we return wrapping it into
internal monad using <em>ret</em> method.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MaybeT</span><span class="o">&lt;</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonadTrans</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">maybeT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">M</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">m</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;monad has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">m</span><span class="o">.</span><span class="na">ret</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">maybeT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">m</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;monad has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">m</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">MaybeT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runMaybeT</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">m</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">runMaybeT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">if</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">isNothing</span><span class="o">())</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">runMaybeT</span><span class="o">().</span><span class="na">ret</span><span class="o">((</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">Maybe</span><span class="o">.</span><span class="na">nothing</span><span class="o">());</span>
</span><span class='line'>            <span class="k">else</span><span class="o">{</span>
</span><span class='line'>                <span class="k">return</span> <span class="o">((</span><span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">value</span><span class="o">())).</span><span class="na">runMaybeT</span><span class="o">();</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">runMaybeT</span><span class="o">().</span><span class="na">ret</span><span class="o">(</span><span class="n">Maybe</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="n">b</span><span class="o">)));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">MaybeT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">runMaybeT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runMaybeT</span><span class="o">().</span><span class="na">ret</span><span class="o">((</span><span class="n">Maybe</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">a</span><span class="o">.</span><span class="na">fmap</span><span class="o">(</span><span class="n">f</span><span class="o">));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Next is <em>EitherT&lt;M,A,B&gt;</em> monad transformer. It&rsquo;s written almost the same as <em>MaybeT</em> but inside it&rsquo;s a <em>Monad&lt;Either&lt;A,B&gt;&gt;</em> but instead we operate with right and left values inside bind function.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EitherT</span><span class="o">&lt;</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonadTrans</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">EitherT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">eitherT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">M</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">m</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;monad has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">EitherT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">m</span><span class="o">.</span><span class="na">ret</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">EitherT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">eitherT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">m</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;monad has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">EitherT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">m</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">EitherT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runEitherT</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">m</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nf">EitherT</span><span class="o">(</span><span class="n">runEitherT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">if</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">isLeft</span><span class="o">())</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">runEitherT</span><span class="o">().</span><span class="na">ret</span><span class="o">((</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">Either</span><span class="o">.</span><span class="na">left</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">left</span><span class="o">()));</span>
</span><span class='line'>            <span class="k">else</span><span class="o">{</span>
</span><span class='line'>                <span class="k">return</span> <span class="o">((</span><span class="n">EitherT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">right</span><span class="o">())).</span><span class="na">runEitherT</span><span class="o">();</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">C</span> <span class="n">c</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nf">EitherT</span><span class="o">(</span><span class="n">runEitherT</span><span class="o">().</span><span class="na">ret</span><span class="o">(</span><span class="n">Either</span><span class="o">.</span><span class="na">right</span><span class="o">(</span><span class="n">c</span><span class="o">)));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nf">EitherT</span><span class="o">(</span><span class="n">runEitherT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runEitherT</span><span class="o">().</span><span class="na">ret</span><span class="o">((</span><span class="n">Either</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">C</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">a</span><span class="o">.</span><span class="na">fmap</span><span class="o">(</span><span class="n">f</span><span class="o">));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now let&rsquo;s implement <em>ReaderT&lt;E,M,A&gt;</em> monad transformer. Internally it&rsquo;s implemented as <em>Function&lt;E,Monad&lt;A&gt;&gt;</em>. Basically it&rsquo;s implementation mimics that of <em>Reader</em> monad however
instead of <em>A</em> value we are dealing with <em>Monad&lt;A&gt;</em>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonadTrans</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">readerT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">f</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;argument has no value&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">f</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">ReaderT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runReaderT</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">E</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ask</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">E</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">E</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runReaderT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">E</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runReaderT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">).</span><span class="na">bind</span><span class="o">(</span><span class="n">f</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">E</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runReaderT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">ReaderT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">E</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">E</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runReaderT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">).</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>                <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">){</span>
</span><span class='line'>                    <span class="k">return</span> <span class="nf">runReaderT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">a</span><span class="o">));</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">});</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Next monad transformer is <em>WriterT&lt;W,M,A&gt;</em>. This one is implemented internally as <em>Monad&lt;Tuple&lt;A,W&gt;&gt;</em> and follows the same pattern as <em>MaybeT</em> and <em>EitherT</em> monad transformer implementations.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WriterT</span><span class="o">&lt;</span><span class="n">W</span> <span class="kd">extends</span> <span class="n">Monoid</span><span class="o">,</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonadTrans</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span> <span class="kd">extends</span> <span class="n">Monoid</span><span class="o">,</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">writerT</span><span class="o">(</span><span class="kd">final</span> <span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="kd">final</span> <span class="n">W</span> <span class="n">w</span><span class="o">,</span> <span class="kd">final</span> <span class="n">M</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">A</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;((</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;)</span><span class="n">m</span><span class="o">.</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">w</span><span class="o">)));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">WriterT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runWriterT</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">m</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">tell</span><span class="o">(</span><span class="kd">final</span> <span class="n">W</span> <span class="n">w</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">runWriterT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span>
</span><span class='line'>        <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>            <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">runWriterT</span><span class="o">().</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">Unit</span><span class="o">.</span><span class="na">unit</span><span class="o">(),(</span><span class="n">W</span><span class="o">)</span><span class="n">t</span><span class="o">.</span><span class="na">second</span><span class="o">().</span><span class="na">mappend</span><span class="o">(</span><span class="n">w</span><span class="o">)));</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">runWriterT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="o">((</span><span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;)</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">first</span><span class="o">())).</span><span class="na">runWriterT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span>
</span><span class='line'>                <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>                    <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t2</span><span class="o">){</span>
</span><span class='line'>                        <span class="k">return</span> <span class="nf">runWriterT</span><span class="o">().</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">t2</span><span class="o">.</span><span class="na">first</span><span class="o">(),</span><span class="n">t</span><span class="o">.</span><span class="na">second</span><span class="o">()));</span>
</span><span class='line'>                    <span class="o">}</span>
</span><span class='line'>            <span class="o">});</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">runWriterT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runWriterT</span><span class="o">().</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">b</span><span class="o">,</span><span class="n">t</span><span class="o">.</span><span class="na">second</span><span class="o">()));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">WriterT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">W</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="n">runWriterT</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">W</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runWriterT</span><span class="o">().</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">first</span><span class="o">()),</span><span class="n">t</span><span class="o">.</span><span class="na">second</span><span class="o">()));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}));</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Last monad transformer we are implementing is <em>StateT&lt;S,M,A&gt;</em>. It&rsquo;s the most complex implementation among all monad transformers.
Internally it mimics <em>State</em> monad however it&rsquo;s implemented as <em>Function&lt;S,Monad&lt;Tuple&lt;A,S&gt;&gt;&gt;</em> so general implementation
follows that of <em>State</em> with the difference that function returns monad but not a value. You can study this source code line by line
to better understand all the inner workings however I strongly encourage you to try implement it yourself. In a matter of fact try writing all the monad transformers from scratch yourself
and you&rsquo;ll grok their beauty easily.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span> <span class="kd">extends</span> <span class="n">Monad</span><span class="o">,</span><span class="n">A</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMonadTrans</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">private</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">private</span> <span class="nf">StateT</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">runStateT</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">f</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">get</span><span class="o">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runStateT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">s</span><span class="o">,</span><span class="n">s</span><span class="o">));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="n">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">put</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">ns</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">Unit</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span>
</span><span class='line'>        <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>            <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Unit</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">runStateT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">Unit</span><span class="o">.</span><span class="na">unit</span><span class="o">(),</span><span class="n">ns</span><span class="o">));</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">bind</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span>
</span><span class='line'>        <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>            <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">runStateT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">bind</span><span class="o">(</span>
</span><span class='line'>                    <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>                        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>                            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">first</span><span class="o">()).</span><span class="na">bind</span><span class="o">(</span>
</span><span class='line'>                                <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>                                    <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>                                        <span class="k">return</span> <span class="nf">runStateT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">b</span><span class="o">,</span><span class="n">s</span><span class="o">));</span>
</span><span class='line'>                                    <span class="o">}</span>
</span><span class='line'>                            <span class="o">});</span>
</span><span class='line'>                        <span class="o">}</span>
</span><span class='line'>                <span class="o">});</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">ret</span><span class="o">(</span><span class="kd">final</span> <span class="n">B</span> <span class="n">b</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span>
</span><span class='line'>        <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>            <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">runStateT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">b</span><span class="o">,</span><span class="n">s</span><span class="o">));</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">Functor</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">fmap</span><span class="o">(</span><span class="kd">final</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">f</span><span class="o">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">StateT</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">M</span><span class="o">,</span><span class="n">B</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;(</span><span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">S</span><span class="o">,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">S</span> <span class="n">s</span><span class="o">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">runStateT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">bind</span><span class="o">(</span>
</span><span class='line'>                <span class="k">new</span> <span class="n">Function</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;,</span><span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;(){</span>
</span><span class='line'>                    <span class="kd">public</span> <span class="n">Monad</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">B</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">apply</span><span class="o">(</span><span class="kd">final</span> <span class="n">Tuple</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">A</span><span class="o">,</span><span class="n">S</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>                        <span class="k">return</span> <span class="nf">runStateT</span><span class="o">().</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">ret</span><span class="o">(</span>
</span><span class='line'>                            <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">first</span><span class="o">()),</span><span class="n">s</span><span class="o">)</span>
</span><span class='line'>                        <span class="o">);</span>
</span><span class='line'>                    <span class="o">}</span>
</span><span class='line'>            <span class="o">});</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">});</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>That&rsquo;s all folks! We&rsquo;ve implemented a small functional library in <strong>Java</strong>, it&rsquo;s not complete and not as powerful as <a href="http://www.functionaljava.org/">Functional Java</a>, however doing so brings us a little bit closer to functional zen. Long road still lays ahead of us as we journey this path of functional programming, but we are stronger than we were! Good luck to you all adventurers and happy functional programming!</p>

<p><img src="http://i.imgur.com/9gKTf4u.jpg" alt="Rikka Kawaii" /></p>
]]></content>
  </entry>
  
</feed>
